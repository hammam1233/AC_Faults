<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="موسوعة أعطال التكييف: ابحث عن حلول سريعة لأعطال المكيفات، غرف التبريد، والشيلرات باللغتين العربية والإنجليزية.">
    <meta name="keywords" content="أعطال المكيفات, أكواد أخطاء المكيفات, صيانة مكيفات, تشخيص الأعطال, شيلرات, غرف تبريد">
    <title>موسوعة أعطال التكييف</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3732463135652606" crossorigin="anonymous"></script>
    <style>
        :root {
            --primary-bg-color: #B0E0E6; /* Light Blue */
            --accent-color: #f39c12; /* Orange */
            --dark-text-color: #333;
            --light-text-color: #ffffff;
            --card-bg-color: #ffffff;
            --card-header-bg: #007bff; /* Blue - Original in your file */
            --dark-blue-header: #0056b3; /* Added: Darker blue for headers */
            --shadow-color: rgba(0,0,0,0.1);
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--primary-bg-color);
            color: var(--dark-text-color);
            margin: 0;
            padding: 0;
            width: 100%;
            text-align: center; /* This centers block-level elements like container if it's less than 100% width and display:block */
        }
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto; /* Centering the container */
            padding: 0 15px; /* Add some horizontal padding */
        }
        .content-wrapper {
            text-align: center; /* This will center inline-block elements */
            margin: 0 auto; /* Centering the wrapper itself */
            padding: 10px 0; /* Reduced vertical padding */
        }
        .intro-text {
            text-align: center;
            margin: 0 auto; /* Centering this block */
            padding: 10px 0;
            margin-top: 20px; /* Reduced top margin */
        }
        .intro-text h1 {
            font-family: 'Tajawal', sans-serif;
            font-size: 3rem;
            margin: 0;
            padding: 5px 0;
            color: var(--dark-blue-header); /* Changed to dark blue header */
        }
        .intro-text p {
            font-family: 'Tajawal', sans-serif;
            font-size: 1.1rem;
            margin: 0;
            padding: 5px 0;
            color: var(--dark-text-color);
        }
        .consult-section {
            margin: 20px 0; /* Space for the button */
        }
        .consult-btn {
            display: inline-block;
            background-color: var(--accent-color);
            color: var(--light-text-color);
            padding: 15px 30px; /* Larger padding for prominence */
            border-radius: 10px; /* Slightly more rounded */
            text-decoration: none;
            font-weight: bold;
            font-size: 20px; /* Larger font size */
            transition: background-color 0.3s ease;
            box-shadow: 0 4px 8px var(--shadow-color); /* Add shadow for depth */
        }
        .consult-btn:hover {
            background-color: #e67e22; /* Darker orange on hover */
            color: var(--light-text-color);
            transform: translateY(-2px); /* Slight lift effect */
        }
        .consult-note {
            font-size: 14px;
            color: #555;
            margin-top: 10px;
        }

        .search-bar {
            margin: 30px auto; /* Changed to auto to center and reduced margin */
            padding: 0;
            max-width: 800px;
            /* Removed display: inline-block; */
            width: 100%; /* Ensure it takes full width within its container */
        }
        .search-bar .form-control {
            border-radius: 8px;
            padding: 10px 15px;
            font-size: 1.1rem;
            border: 1px solid #ccc;
        }
        #search-results {
            margin-top: 20px;
        }
        #search-results .card {
            margin-bottom: 15px; /* Space between search result cards */
        }


        .section-title {
            margin: 40px auto 20px auto; /* Changed to auto to center and reduced margin */
            padding: 0;
            max-width: 800px;
            /* Removed display: inline-block; */
            width: 100%; /* Ensure it takes full width within its container */
        }
        .section-title h2 {
            font-family: 'Tajawal', sans-serif;
            font-size: 2rem; /* Slightly larger heading */
            margin: 0;
            padding: 0;
            color: var(--dark-blue-header); /* Changed to dark blue header */
            border-bottom: 2px solid var(--accent-color); /* Underline effect */
            padding-bottom: 10px;
        }
        .dropdown {
            margin: 15px auto; /* Centered with auto margins and reduced */
            max-width: 700px; /* Limit width for dropdowns as well */
        }
        .dropdown label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--dark-text-color);
        }
        .form-select {
            border-radius: 8px;
            padding: 10px 15px;
            font-size: 1rem;
            border: 1px solid #ccc;
            background-color: var(--card-bg-color);
            color: var(--dark-text-color);
        }

        .card {
            margin: 20px auto; /* Centered with auto margins and reduced */
            padding: 0;
            border-radius: 12px; /* More rounded corners */
            box-shadow: 0 5px 15px var(--shadow-color); /* More prominent shadow */
            background-color: var(--card-bg-color);
            border: none; /* Remove default bootstrap border */
            max-width: 700px; /* Max width for cards */
        }
        .card-header {
            background-color: var(--dark-blue-header); /* Changed to dark blue header */
            color: var(--light-text-color);
            font-weight: bold;
            border-radius: 12px 12px 0 0;
            margin: 0;
            padding: 12px 15px; /* Adjusted padding */
            font-size: 1.2rem;
        }
        .card-body {
            margin: 0;
            padding: 20px; /* Increased padding inside body */
            text-align: right; /* Default for RTL */
        }
        .card-body p {
            margin-bottom: 10px;
            line-height: 1.6;
        }
        .card-body p:last-child {
            margin-bottom: 0;
        }
        .card-body strong {
            color: var(--dark-blue-header); /* Changed to dark blue header */
        }

        .coming-soon {
            font-size: 1.5rem;
            color: #888;
            padding: 40px;
            text-align: center;
        }
        .coming-soon i {
            margin-bottom: 15px;
            display: block;
            font-size: 2.5rem;
            color: #bbb;
        }

        .lang-switch {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: var(--accent-color);
            color: var(--light-text-color);
            padding: 10px 18px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-family: 'Tajawal', sans-serif;
            z-index: 1000;
            box-shadow: 0 3px 6px var(--shadow-color);
            transition: background-color 0.3s ease;
        }
        .lang-switch:hover {
            background-color: #e67e22;
        }
        .lang-switch i {
            margin-left: 8px; /* Space between icon and text for RTL */
        }

        /* RTL specific styles */
        [dir="rtl"] body {
            text-align: right;
        }
        [dir="rtl"] .intro-text,
        [dir="rtl"] .search-bar,
        [dir="rtl"] .section-title,
        [dir="rtl"] .card-body {
            text-align: right; /* Ensure text is right-aligned in RTL */
        }
        [dir="rtl"] .lang-switch {
            right: 20px; /* Keep it on the right in RTL */
            left: auto;
        }
        [dir="rtl"] .lang-switch i {
            margin-left: 8px;
            margin-right: 0;
        }

        /* LTR specific styles */
        [dir="ltr"] body {
            font-family: 'Roboto', sans-serif;
            text-align: left;
        }
        [dir="ltr"] .intro-text,
        [dir="ltr"] .search-bar,
        [dir="ltr"] .section-title,
        [dir="ltr"] .card-body {
            text-align: left; /* Ensure text is left-aligned in LTR */
        }
        [dir="ltr"] .lang-switch {
            right: auto;
            left: 20px; /* Move to left in LTR */
        }
        [dir="ltr"] .lang-switch i {
            margin-right: 8px;
            margin-left: 0;
        }

        @media (max-width: 768px) {
            .intro-text h1 {
                font-size: 2.2rem;
            }
            .intro-text p {
                font-size: 0.95rem;
            }
            .section-title h2 {
                font-size: 1.7rem;
            }
            .section-title {
                margin: 30px auto 15px auto; /* Centered on small screens too */
            }
            .card {
                margin: 15px auto;
            }
            .card-body {
                padding: 15px;
            }
            .consult-btn {
                font-size: 16px;
                padding: 12px 24px;
            }
            .lang-switch {
                top: 15px;
                right: 15px;
                font-size: 13px;
                padding: 6px 12px;
            }
            [dir="ltr"] .lang-switch {
                left: 15px;
            }
            .search-bar .form-control {
                font-size: 1rem;
            }
            .form-select {
                font-size: 0.95rem;
            }
        }
    </style>
</head>
<body>
    <div class="lang-switch" id="lang-switch">
        <i class="fas fa-globe"></i> English
    </div>

    <div class="container">
        <div class="content-wrapper">
            <div class="intro-text">
                <h1 id="intro-title">موسوعة أعطال التكييف</h1>
                <p id="intro-description">ابحث عن حلول سريعة لأعطال المكيفات، غرف التبريد، والشيلرات باللغتين العربية والإنجليزية. موقعك الموثوق لصيانة المكيفات!</p>
                <div class="consult-section">
                    <a href="https://wa.me/+966539518738?text=أريد استشارة فورية" class="consult-btn" id="consult-btn">
                        <i class="fas fa-headset"></i> استشارة فورية (مدفوعة)
                    </a>
                    <p id="consult-note" class="consult-note">اضغط للتواصل عبر واتساب، وسنرسل رابط الدفع بعد إرسال استشارتك.</p>
                </div>
            </div>

            <div class="search-bar">
                <input type="text" id="search-input" class="form-control" placeholder="ابحث عن عطل أو كود (مثل: لا يبرد أو F1)">
                <div id="search-results"></div>
            </div>

            <section id="symptoms" class="section-title">
                <h2 id="symptoms-title"><i class="fas fa-exclamation-circle"></i> الأعراض</h2>
                <div class="dropdown">
                    <label for="ac-type" id="label-ac-type">اختر نوع المكيف:</label>
                    <select id="ac-type" class="form-select">
                        <option value="">-- اختر نوع المكيف --</option>
                    </select>
                </div>
                <div class="dropdown">
                    <label for="symptom" id="label-symptom">اختر العطل:</label>
                    <select id="symptom" class="form-select" disabled>
                        <option value="">-- اختر العطل --</option>
                    </select>
                </div>
                <div id="fault-details"></div>
            </section>

            <section id="codes" class="section-title">
                <h2 id="codes-title"><i class="fas fa-code"></i> أكواد الأخطاء</h2>
                <div class="dropdown">
                    <label for="ac-code-type" id="label-ac-code-type">اختر نوع التكييف:</label>
                    <select id="ac-code-type" class="form-select">
                        <option value="">-- اختر نوع التكييف --</option>
                        <option value="عادي">عادي</option>
                        <option value="إنفيرتر">إنفيرتر</option>
                    </select>
                </div>
                <div class="dropdown">
                    <label for="code" id="label-code">اختر الكود:</label>
                    <select id="code" class="form-select" disabled>
                        <option value="">-- اختر الكود --</option>
                    </select>
                </div>
                <div id="code-details"></div>
            </section>

            <section id="chillers" class="section-title">
                <h2 id="chillers-title"><i class="fas fa-fan"></i> أعطال الشيلر</h2>
                <div class="dropdown" id="chiller-dropdown-container">
                    <label for="chiller-fault" id="label-chiller-fault">اختر عطل الشيلر:</label>
                    <select id="chiller-fault" class="form-select">
                        <option value="">-- اختر عطل الشيلر --</option>
                    </select>
                </div>
                <div id="chiller-details"></div>
            </section>

            <section id="cooling-rooms" class="section-title">
                <h2 id="cooling-rooms-title"><i class="fas fa-snowflake"></i> أعطال غرف التبريد والتجميد</h2>
                <div class="dropdown" id="cooling-room-dropdown-container">
                    <label for="cooling-room-fault" id="label-cooling-room-fault">اختر عطل غرفة التبريد:</label>
                    <select id="cooling-room-fault" class="form-select">
                        <option value="">-- اختر عطل غرفة التبريد --</option>
                    </select>
                </div>
                <div id="cooling-room-details"></div>
            </section>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let currentLang = 'ar';
        const acTypeTranslations = {
            ar: {
                'شباك': 'شباك',
                'سبليت': 'سبليت',
                'باكدج': 'باكدج',
                'مخفي دولابي/كاسيت': 'مخفي دولابي/كاسيت',
                'عادي': 'عادي',
                'إنفيرتر': 'إنفيرتر'
            },
            en: {
                'شباك': 'Window',
                'سبليت': 'Split',
                'باكدج': 'Package',
                'مخفي دولابي/كاسيت': 'Concealed/Free Stand/Cassette',
                'عادي': 'Normal',
                'إنفيرتر': 'Inverter'
            }
        };
        const translations = {
            ar: {
                title: 'موسوعة أعطال التكييف',
                introDescription: 'ابحث عن حلول سريعة لأعطال المكيفات، غرف التبريد، والشيلرات باللغتين العربية والإنجليزية. موقعك الموثوق لصيانة المكيفات!',
                consultBtn: 'استشارة فورية (مدفوعة)',
                consultNote: 'اضغط للتواصل عبر واتساب، وسنرسل رابط الدفع بعد إرسال استشارتك.',
                symptoms: 'الأعراض',
                codes: 'أكواد الأخطاء',
                chillers: 'أعطال الشيلر',
                coolingRooms: 'أعطال غرف التبريد والتجميد',
                selectAcType: 'اختر نوع المكيف:',
                selectSymptom: 'اختر العطل:',
                selectCodeType: 'اختر نوع التكييف:',
                selectCode: 'اختر الكود:',
                selectChillerFault: 'اختر عطل الشيلر:', // New
                selectCoolingRoomFault: 'اختر عطل غرفة التبريد:', // New
                check: 'الفحص',
                solution: 'الحل',
                switchLang: 'English',
                searchPlaceholder: 'ابحث عن عطل أو كود (مثل: لا يبرد أو F1)',
                comingSoon: 'قريبًا',
                selectOption: '-- اختر --'
            },
            en: {
                title: 'Air Conditioning Faults Encyclopedia',
                introDescription: 'Find quick solutions for air conditioner, cooling room, and chiller faults in Arabic and English. Your trusted source for AC maintenance!',
                consultBtn: 'Instant Consultation (Paid)',
                consultNote: 'Click to contact us via WhatsApp, and we will send a payment link after receiving your consultation.',
                symptoms: 'Symptoms',
                codes: 'Error Codes',
                chillers: 'Chiller Faults',
                coolingRooms: 'Cooling Room & Freezing Faults',
                selectAcType: 'Select AC Type:',
                selectSymptom: 'Select Symptom:',
                selectCodeType: 'Select AC Type:',
                selectCode: 'Select Code:',
                selectChillerFault: 'Select Chiller Fault:', // New
                selectCoolingRoomFault: 'Select Cooling Room Fault:', // New
                check: 'Check',
                solution: 'Solution',
                switchLang: 'العربية',
                searchPlaceholder: 'Search for a symptom or code (e.g., Does not cool or F1)',
                comingSoon: 'Coming Soon',
                selectOption: '-- Select --'
            }
        };

        function switchLanguage() {
            currentLang = currentLang === 'ar' ? 'en' : 'ar';
            $('html').attr('lang', currentLang).attr('dir', currentLang === 'ar' ? 'rtl' : 'ltr');
            $('title').text(translations[currentLang].title);
            $('#intro-title').text(translations[currentLang].title);
            $('#intro-description').text(translations[currentLang].introDescription);
            $('#consult-btn').html(`<i class="fas fa-headset"></i> ${translations[currentLang].consultBtn}`);
            $('#consult-note').text(translations[currentLang].consultNote);

            $('#symptoms-title').html(`<i class="fas fa-exclamation-circle"></i> ${translations[currentLang].symptoms}`);
            $('#codes-title').html(`<i class="fas fa-code"></i> ${translations[currentLang].codes}`);
            $('#chillers-title').html(`<i class="fas fa-fan"></i> ${translations[currentLang].chillers}`);
            $('#cooling-rooms-title').html(`<i class="fas fa-snowflake"></i> ${translations[currentLang].coolingRooms}`);
            
            $('#label-ac-type').text(translations[currentLang].selectAcType);
            $('#label-symptom').text(translations[currentLang].selectSymptom);
            $('#label-ac-code-type').text(translations[currentLang].selectCodeType);
            $('#label-code').text(translations[currentLang].selectCode);
            $('#label-chiller-fault').text(translations[currentLang].selectChillerFault); // New
            $('#label-cooling-room-fault').text(translations[currentLang].selectCoolingRoomFault); // New

            $('#ac-type option[value=""]').text(`-- ${translations[currentLang].selectAcType} --`);
            $('#symptom option[value=""]').text(`-- ${translations[currentLang].selectSymptom} --`);
            $('#ac-code-type option[value=""]').text(`-- ${translations[currentLang].selectCodeType} --`);
            $('#code option[value=""]').text(`-- ${translations[currentLang].selectCode} --`);
            $('#chiller-fault option[value=""]').text(`-- ${translations[currentLang].selectChillerFault} --`); // New
            $('#cooling-room-fault option[value=""]').text(`-- ${translations[currentLang].selectCoolingRoomFault} --`); // New

            $('#search-input').attr('placeholder', translations[currentLang].searchPlaceholder);
            $('#lang-switch').html(`<i class="fas fa-globe"></i> ${translations[currentLang].switchLang}`);
            
            // Re-populate dropdowns and clear details based on new language
            updateSymptoms();
            updateCodes();
            updateChillers();
            updateCoolingRooms();
            $('#search-input').val('').trigger('input'); // Clear search and re-trigger to update results if any
        }

        function updateSymptoms() {
            const acTypeSelect = $('#ac-type');
            const symptomSelect = $('#symptom');
            const faultDetails = $('#fault-details');

            fetch('faults.json')
                .then(response => {
                    if (!response.ok) throw new Error('Failed to load faults.json');
                    return response.json();
                })
                .then(data => {
                    acTypeSelect.empty().append(`<option value="">-- ${translations[currentLang].selectAcType} --</option>`);
                    symptomSelect.prop('disabled', true).empty().append(`<option value="">-- ${translations[currentLang].selectSymptom} --</option>`);
                    faultDetails.empty();

                    for (const acType in data) {
                        // Use acTypeTranslations for display, but keep original value for logic
                        acTypeSelect.append(`<option value="${acType}">${acTypeTranslations[currentLang][acType] || acType}</option>`);
                    }

                    acTypeSelect.off('change').on('change', function() {
                        const selectedType = $(this).val();
                        symptomSelect.prop('disabled', true).empty().append(`<option value="">-- ${translations[currentLang].selectSymptom} --</option>`);
                        faultDetails.empty();

                        if (selectedType && data[selectedType]) {
                            // Determine the language key to use from the JSON structure
                            const langKey = data[selectedType][currentLang] ? currentLang : 'ar'; // Fallback to 'ar' if currentLang not found
                            symptomSelect.prop('disabled', false);
                            for (const symptom in data[selectedType][langKey]) {
                                symptomSelect.append(`<option value="${symptom}">${symptom}</option>`);
                            }
                        }
                    });

                    symptomSelect.off('change').on('change', function() {
                        const selectedType = acTypeSelect.val();
                        const selectedSymptom = $(this).val();
                        faultDetails.empty();

                        if (selectedType && selectedSymptom && data[selectedType]) {
                            const langKey = data[selectedType][currentLang] ? currentLang : 'ar';
                            const fault = data[selectedType][langKey][selectedSymptom];
                            if (fault) {
                                faultDetails.append(`
                                    <div class="card">
                                        <div class="card-header">${translations[currentLang].symptoms}: ${selectedSymptom} (${acTypeTranslations[currentLang][selectedType] || selectedType})</div>
                                        <div class="card-body">
                                            <p><strong>${translations[currentLang].check}:</strong> ${fault[langKey === 'ar' ? 'فحص' : 'Check']}</p>
                                            <p><strong>${translations[currentLang].solution}:</strong> ${fault[langKey === 'ar' ? 'حل' : 'Solution']}</p>
                                        </div>
                                    </div>
                                `);
                            }
                        }
                    });
                })
                .catch(error => console.error('Error loading faults.json:', error));
        }

        function updateCodes() {
            const acCodeTypeSelect = $('#ac-code-type');
            const codeSelect = $('#code');
            const codeDetails = $('#code-details');

            const jsonFile = currentLang === 'ar' ? 'faults2.json' : 'faults3.json';
            fetch(jsonFile)
                .then(response => {
                    if (!response.ok) throw new Error(`Failed to load ${jsonFile}`);
                    return response.json();
                })
                .then(codes => {
                    acCodeTypeSelect.empty().append(`<option value="">-- ${translations[currentLang].selectCodeType} --</option>`);
                    // Ensure categories are unique and respect translation if available
                    const types = [...new Set(codes.map(code => code.category))];
                    types.forEach(type => {
                        acCodeTypeSelect.append(`<option value="${type}">${acTypeTranslations[currentLang][type] || type}</option>`);
                    });

                    codeSelect.prop('disabled', true).empty().append(`<option value="">-- ${translations[currentLang].selectCode} --</option>`);
                    codeDetails.empty();

                    acCodeTypeSelect.off('change').on('change', function() {
                        const selectedType = $(this).val();
                        codeSelect.prop('disabled', true).empty().append(`<option value="">-- ${translations[currentLang].selectCode} --</option>`);
                        codeDetails.empty();

                        if (selectedType) {
                            const codeList = codes
                                .filter(code => code.category === selectedType)
                                .map(code => code.fault_name);
                            codeSelect.prop('disabled', false);
                            codeList.forEach(code => {
                                codeSelect.append(`<option value="${code}">${code}</option>`);
                            }
);
                        }
                    });

                    codeSelect.off('change').on('change', function() {
                        const selectedType = acCodeTypeSelect.val();
                        const selectedCode = $(this).val();
                        codeDetails.empty();

                        const code = codes.find(code => 
                            code.category === selectedType && 
                            code.fault_name === selectedCode);

                        if (code) {
                            codeDetails.append(`
                                <div class="card">
                                    <div class="card-header">${translations[currentLang].codes}: ${code.fault_name} (${acTypeTranslations[currentLang][code.category] || code.category})</div>
                                    <div class="card-body">
                                        <p><strong>${translations[currentLang].check}:</strong> ${code.check_text}</p>
                                        <p><strong>${translations[currentLang].solution}:</strong> ${code.solution}</p>
                                    </div>
                                </div>
                            `);
                        }
                    });
                })
                .catch(error => console.error(`Error loading ${jsonFile}:`, error));
        }

        // START OF MODIFICATIONS FOR "COMING SOON" LOGIC
        function showComingSoon(detailsDiv, selectElement, containerId) {
            detailsDiv.html(`
                <div class="card">
                    <div class="card-body coming-soon">
                        <i class="fas fa-hourglass-half"></i> <span id="${containerId}-coming-soon-text">${translations[currentLang].comingSoon}</span>
                    </div>
                </div>
            `);
            selectElement.empty().append(`<option value="">-- ${translations[currentLang].selectOption} --</option>`);
            selectElement.prop('disabled', true); // Disable dropdown when showing coming soon
            $(`#${containerId}`).hide(); // Hide the dropdown container itself
        }

        function hideComingSoon(detailsDiv, selectElement, containerId) {
            detailsDiv.empty();
            selectElement.prop('disabled', false); // Enable dropdown
            $(`#${containerId}`).show(); // Show the dropdown container
        }

        function updateCoolingRooms() {
            const coolingRoomSelect = $('#cooling-room-fault');
            const coolingRoomDetailsDiv = $('#cooling-room-details');
            const coolingRoomDropdownContainer = $('#cooling-room-dropdown-container');

            // Set initial state to "Coming Soon"
            showComingSoon(coolingRoomDetailsDiv, coolingRoomSelect, 'cooling-room-dropdown-container');

            fetch('cooling_rooms.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('cooling_rooms.json not found or failed to load');
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.length === 0) { // If JSON is empty
                        showComingSoon(coolingRoomDetailsDiv, coolingRoomSelect, 'cooling-room-dropdown-container');
                        console.warn('cooling_rooms.json is empty, showing "Coming Soon".');
                        return; // Exit if no data
                    }

                    hideComingSoon(coolingRoomDetailsDiv, coolingRoomSelect, 'cooling-room-dropdown-container');
                    
                    // Populate dropdown
                    coolingRoomSelect.empty().append(`<option value="">-- ${translations[currentLang].selectCoolingRoomFault} --</option>`);
                    data.forEach(fault => {
                        const faultName = fault.name[currentLang] || fault.name.ar;
                        coolingRoomSelect.append(`<option value="${faultName}">${faultName}</option>`);
                    });

                    // Add change listener to the dropdown
                    coolingRoomSelect.off('change').on('change', function() {
                        const selectedFaultName = $(this).val();
                        coolingRoomDetailsDiv.empty(); // Clear previous details

                        if (selectedFaultName) {
                            const fault = data.find(f => (f.name[currentLang] || f.name.ar) === selectedFaultName);
                            if (fault) {
                                coolingRoomDetailsDiv.append(`
                                    <div class="card">
                                        <div class="card-header">${translations[currentLang].coolingRooms}: ${fault.name[currentLang] || fault.name.ar}</div>
                                        <div class="card-body">
                                            <p><strong>${translations[currentLang].check}:</strong> ${fault.check[currentLang] || fault.check.ar}</p>
                                            <p><strong>${translations[currentLang].solution}:</strong> ${fault.solution[currentLang] || fault.solution.ar}</p>
                                        </div>
                                    </div>
                                `);
                            }
                        }
                    });
                })
                .catch(error => {
                    console.warn(`Cooling Rooms data loading error: ${error.message}`);
                    showComingSoon(coolingRoomDetailsDiv, coolingRoomSelect, 'cooling-room-dropdown-container');
                });
        }

        function updateChillers() {
            const chillerSelect = $('#chiller-fault');
            const chillerDetailsDiv = $('#chiller-details');
            const chillerDropdownContainer = $('#chiller-dropdown-container');

            // Set initial state to "Coming Soon"
            showComingSoon(chillerDetailsDiv, chillerSelect, 'chiller-dropdown-container');

            fetch('chillers.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('chillers.json not found or failed to load');
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.length === 0) { // If JSON is empty
                        showComingSoon(chillerDetailsDiv, chillerSelect, 'chiller-dropdown-container');
                        console.warn('chillers.json is empty, showing "Coming Soon".');
                        return; // Exit if no data
                    }

                    hideComingSoon(chillerDetailsDiv, chillerSelect, 'chiller-dropdown-container');
                    
                    // Populate dropdown
                    chillerSelect.empty().append(`<option value="">-- ${translations[currentLang].selectChillerFault} --</option>`);
                    data.forEach(fault => {
                        const faultName = fault.name[currentLang] || fault.name.ar;
                        chillerSelect.append(`<option value="${faultName}">${faultName}</option>`);
                    });

                    // Add change listener to the dropdown
                    chillerSelect.off('change').on('change', function() {
                        const selectedFaultName = $(this).val();
                        chillerDetailsDiv.empty(); // Clear previous details

                        if (selectedFaultName) {
                            const fault = data.find(f => (f.name[currentLang] || f.name.ar) === selectedFaultName);
                            if (fault) {
                                chillerDetailsDiv.append(`
                                    <div class="card">
                                        <div class="card-header">${translations[currentLang].chillers}: ${fault.name[currentLang] || fault.name.ar}</div>
                                        <div class="card-body">
                                            <p><strong>${translations[currentLang].check}:</strong> ${fault.check[currentLang] || fault.check.ar}</p>
                                            <p><strong>${translations[currentLang].solution}:</strong> ${fault.solution[currentLang] || fault.solution.ar}</p>
                                        </div>
                                    </div>
                                `);
                            }
                        }
                    });
                })
                .catch(error => {
                    console.warn(`Chiller data loading error: ${error.message}`);
                    showComingSoon(chillerDetailsDiv, chillerSelect, 'chiller-dropdown-container');
                });
        }
        // END OF MODIFICATIONS FOR "COMING SOON" LOGIC


        function searchFaultsAndCodes(query) {
            const searchResults = $('#search-results');
            searchResults.empty();

            if (query.trim() === '') {
                return; // Don't show results if query is empty
            }

            const lowerCaseQuery = query.toLowerCase();
            let hasResults = false;

            // Search in faults.json (Symptoms)
            fetch('faults.json')
                .then(response => response.ok ? response.json() : Promise.reject('faults.json not found'))
                .then(data => {
                    for (const acType in data) {
                        const langKey = data[acType][currentLang] ? currentLang : 'ar';
                        for (const symptom in data[acType][langKey]) {
                            const fault = data[acType][langKey][symptom];
                            // Search in symptom name, check, and solution
                            if (symptom.toLowerCase().includes(lowerCaseQuery) ||
                                (fault[langKey === 'ar' ? 'فحص' : 'Check'] && fault[langKey === 'ar' ? 'فحص' : 'Check'].toLowerCase().includes(lowerCaseQuery)) ||
                                (fault[langKey === 'ar' ? 'حل' : 'Solution'] && fault[langKey === 'ar' ? 'حل' : 'Solution'].toLowerCase().includes(lowerCaseQuery))) {
                                searchResults.append(`
                                    <div class="card">
                                        <div class="card-header">${translations[currentLang].symptoms}: ${symptom} (${acTypeTranslations[currentLang][acType] || acType})</div>
                                        <div class="card-body">
                                            <p><strong>${translations[currentLang].check}:</strong> ${fault[langKey === 'ar' ? 'فحص' : 'Check']}</p>
                                            <p><strong>${translations[currentLang].solution}:</strong> ${fault[langKey === 'ar' ? 'حل' : 'Solution']}</p>
                                        </div>
                                    </div>
                                `);
                                hasResults = true;
                            }
                        }
                    }
                })
                .catch(error => console.error('Error loading faults.json for search:', error));

            // Search in faults2.json or faults3.json (Error Codes)
            const jsonFile = currentLang === 'ar' ? 'faults2.json' : 'faults3.json';
            fetch(jsonFile)
                .then(response => response.ok ? response.json() : Promise.reject(`${jsonFile} not found`))
                .then(codes => {
                    codes.forEach(code => {
                        if (code.fault_name.toLowerCase().includes(lowerCaseQuery) ||
                            code.check_text.toLowerCase().includes(lowerCaseQuery) ||
                            code.solution.toLowerCase().includes(lowerCaseQuery)) {
                            searchResults.append(`
                                <div class="card">
                                    <div class="card-header">${translations[currentLang].codes}: ${code.fault_name} (${acTypeTranslations[currentLang][code.category] || code.category})</div>
                                    <div class="card-body">
                                        <p><strong>${translations[currentLang].check}:</strong> ${code.check_text}</p>
                                        <p><strong>${translations[currentLang].solution}:</strong> ${code.solution}</p>
                                    </div>
                                </div>
                            `);
                            hasResults = true;
                        }
                    });
                })
                .catch(error => console.error(`Error loading ${jsonFile} for search:`, error));
            
            // Search in chillers.json
            fetch('chillers.json')
                .then(response => response.ok ? response.json() : Promise.resolve([]))
                .then(data => {
                    data.forEach(item => {
                        const name = item.name ? (item.name[currentLang] || item.name.ar || item.name) : '';
                        const check = item.check ? (item.check[currentLang] || item.check.ar || item.check) : '';
                        const solution = item.solution ? (item.solution[currentLang] || item.solution.ar || item.solution) : '';

                        if (name.toLowerCase().includes(lowerCaseQuery) ||
                            check.toLowerCase().includes(lowerCaseQuery) ||
                            solution.toLowerCase().includes(lowerCaseQuery)) {
                            searchResults.append(`
                                <div class="card">
                                    <div class="card-header">${translations[currentLang].chillers}: ${name}</div>
                                    <div class="card-body">
                                        <p><strong>${translations[currentLang].check}:</strong> ${check}</p>
                                        <p><strong>${translations[currentLang].solution}:</strong> ${solution}</p>
                                    </div>
                                </div>
                            `);
                            hasResults = true;
                        }
                    });
                })
                .catch(error => console.warn('Chillers JSON not found for search (expected if "coming soon"):', error));
            
            // Search in cooling_rooms.json
            fetch('cooling_rooms.json')
                .then(response => response.ok ? response.json() : Promise.resolve([]))
                .then(data => {
                    data.forEach(item => {
                        const name = item.name ? (item.name[currentLang] || item.name.ar || item.name) : '';
                        const check = item.check ? (item.check[currentLang] || item.check.ar || item.check) : '';
                        const solution = item.solution ? (item.solution[currentLang] || item.solution.ar || item.solution) : '';

                        if (name.toLowerCase().includes(lowerCaseQuery) ||
                            check.toLowerCase().includes(lowerCaseQuery) ||
                            solution.toLowerCase().includes(lowerCaseQuery)) {
                            searchResults.append(`
                                <div class="card">
                                    <div class="card-header">${translations[currentLang].coolingRooms}: ${name}</div>
                                    <div class="card-body">
                                        <p><strong>${translations[currentLang].check}:</strong> ${check}</p>
                                        <p><strong>${translations[currentLang].solution}:</strong> ${solution}</p>
                                    </div>
                                </div>
                            `);
                            hasResults = true;
                        }
                    });
                })
                .catch(error => console.warn('Cooling Rooms JSON not found for search (expected if "coming soon"):', error));
        }

        $(document).ready(function() {
            updateSymptoms();
            updateCodes();
            updateCoolingRooms(); // Call this to show "Coming Soon" or load data
            updateChillers();    // Call this to show "Coming Soon" or load data

            $('#search-input').on('input', function() {
                const query = $(this).val();
                searchFaultsAndCodes(query);
            });
            $('#lang-switch').on('click', switchLanguage);

            // Initial language setup based on HTML dir attribute
            if ($('html').attr('dir') === 'ltr') {
                currentLang = 'en';
            }
            switchLanguage(); // Apply initial translations based on currentLang
        });
    </script>
</body>
</html>